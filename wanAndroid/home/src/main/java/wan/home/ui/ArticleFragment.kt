package wan.home.uiimport android.view.LayoutInflaterimport androidx.fragment.app.viewModelsimport androidx.lifecycle.Lifecycleimport androidx.lifecycle.flowWithLifecycleimport androidx.lifecycle.lifecycleScopeimport androidx.recyclerview.widget.ConcatAdapterimport androidx.recyclerview.widget.LinearLayoutManagerimport com.alibaba.android.arouter.launcher.ARouterimport kotlinx.coroutines.launchimport wan.common.CommonFragmentimport wan.common.RoutePathimport wan.common.RouterKeyimport wan.common.launchWithLoadingimport wan.home.adapter.ArticleAdapterimport wan.home.adapter.HomeBannerAdapterimport wan.home.databinding.FragmentArticleBindingimport wan.home.viewmodel.ArticleViewModel/** * author : TangPeng * date : 2/28/22 17:49 * description : */class ArticleFragment : CommonFragment<FragmentArticleBinding>() {    private val vm: ArticleViewModel by viewModels()    private val adapter by lazy {        ArticleAdapter {            ARouter.getInstance().build(RoutePath.WEB_ACTIVITY).withString(RouterKey.URL, it.link)                .withString(RouterKey.TITLE, it.title).navigation()        }    }    private val bannerAdapter by lazy {        HomeBannerAdapter {}    }    override fun getBinding(inflater: LayoutInflater): FragmentArticleBinding =        FragmentArticleBinding.inflate(inflater)    override fun flowData() {        with(vm) {            launchWithLoading(vm::getHomeArticle)            launchWithLoading(vm::getBanner)            lifecycleScope.launch {                vm.articleState.flowWithLifecycle(lifecycle, Lifecycle.State.STARTED).collect {                    adapter.submitList(it)                }            }            lifecycleScope.launch {                vm.bannerState.flowWithLifecycle(lifecycle, Lifecycle.State.STARTED).collect {                    bannerAdapter.submitList(it)                }            }        }    }    override fun flowView() {        bd.homeRv.layoutManager = LinearLayoutManager(requireContext())        bd.homeRv.adapter = ConcatAdapter(bannerAdapter, adapter)    }    companion object {        @JvmStatic        fun main(args: Array<String>) {        }    }}